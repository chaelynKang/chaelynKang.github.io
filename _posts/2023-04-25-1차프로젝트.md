```
# VLAN & trunk

DSW1 - DSW2]
vlan 10
exit
vlan 20
exit
vlan 30
exit
vlan 40
exit

ASW1]
vlan 10
exit
vlan 20
exit

ASW2]
vlan 30
exit
vlan 40
exit

R1]
vlan 50
exit

R4]
vlan 70
exit

ASW1]
int f1/1
sw mode acc
sw acc vlan 10
exit
int f1/2
sw mode acc
sw acc vlan 20
exit

ASW2]
int f1/3
sw mode acc
sw acc vlan 30
exit
int f1/4
sw mode acc
sw acc vlan 40
exit

R1]
int range f1/5 - 7
sw mode acc
sw acc vlan 50

R4]
int range f1/9 - 10
sw mode acc
sw acc vlan 70
```

```
ASW1]
en
conf t
spanning-tree portfast bpduguard
int range f1/1 - 2
spanning-tree portfast

ASW2]
en
conf t
spanning-tree portfast bpduguard
int range f1/3 - 4
spanning-tree portfast

R1]
en
conf t
spanning-tree portfast bpduguard
int range f1/5 - 7
spanning-tree portfast

R4]
en
conf t
spanning-tree portfast bpduguard
int range f1/9 - 10
spanning-tree portfast


```

```
show frame-relay pvc | include DLCI
int s2/0
no shut
ip add 211.104.54.1 255.255.255.0
encap fram
no fram inver
clock rate 64000
fram map ip 211.104.54.2 102 br
```

```
show frame-relay pvc | include DLCI
int s1/0
no shut
ip add 211.104.54.2 255.255.255.0
encap fram
no fram inver
clock rate 64000
fram map ip 211.104.54.2 201 br
exit
```

```
R1]
UTM]
R4]
CE]
HQ_CE]
```

```
CE]
ip access-list standard BIBI
permit 192.168.10.0 0.0.0.255
permit 192.168.60.0 0.0.0.255
exit
ip nat inside source list BIBI int f1/0 overload
int f0/0
ip nat in
exit
int f0/1
ip nat in
exit
int s2/0
ip nat in
exit
int f1/0
ip nat out
exit
ip nat inside source static 172.16.10.132 1.1.200.1
ip nat inside source static 172.16.10.140 1.1.200.2
ip nat inside source static 172.16.60.254 1.1.200.3
```

```
router ospf 24
router-id 24.24.4.4
network 1.1.100.2 0.0.0.0 a 0
network 172.16.10.131 0.0.0.0 a 0
network 172.16.10.139 0.0.0.0 a 0
network 211.104.54.1 0.0.0.0 area 0
default-information originate
auto-cost reference-bandwidth 1000
redistribute static subnets
```

```
router ospf 24
router-id 24.24.2.2
network 172.16.10.29 0.0.0.0 a 0
network 172.16.10.61 0.0.0.0 a 0
network 172.16.10.93 0.0.0.0 a 0
network 172.16.10.125 0.0.0.0 a 0
network 172.16.10.132 0.0.0.0 a 0
```
```
router ospf 24
router-id 24.24.3.3
network 172.16.10.30 0.0.0.0 area 0
network 172.16.10.62 0.0.0.0 area 0
network 172.16.10.94 0.0.0.0 area 0
network 172.16.10.126 0.0.0.0 area 0
network 172.16.10.140 0.0.0.0 area 0
```

```
int vlan 10
bandwidth 200000
exit
int vlan 20
bandwidth 200000
exit
int vlan 30
bandwidth 200000
exit
int vlan 40
bandwidth 200000
exit
```

```
# 방화벽 6가지 정책

1. IN => OUT : 모든 트래픽 허용
2. IN => DMZ : DNS, HTTP, HTTPS, POP3, SMTP, IMAP, FTP
3. DMZ => IN : 모두 차단
4. DMZ => OUT :  DNS(Recursive Query) , SMTP (나가는 메일)
5. OUT => IN : 모두 차단
6. OUT => DMZ : DNS, HTTP, HTTPs, SMTP, FTP 
```

```
# DMZ
- DMZ는 외부 네트워크와 내부 네트워크 사이에 위치한 중간 지대이다.
- DMZ에는 외부에서 접속 가능한 서비스나 시스템(웹 서버, DNS 서버 등)를 배치하며, 
- 이러한 시스템은 외부에서의 공격으로부터 내부 네트워크를 보호해주는 역할을 한다.
DMZ 정책은 DMZ 영역에서의 트래픽을 허용하거나 차단하는 규칙으로 구성됩니다.
INTERNAL
내부 네트워크에서의 트래픽을 관리하는 정책이다.
내부에서의 트래픽은 기본적으로 허용되며, 보안상의 이유로 특정한 규칙을 적용한다.
예를 들어, 내부에서의 인터넷 사용을 제어하거나, 내부 네트워크에서의 특정한 포트를 차단하는 등의 규칙이 적용될 수 있다.
EXTERNAL
외부에서 내부 네트워크로 들어오는 트래픽을 관리하는 정책이다.
외부에서 내부 네트워크로의 접근은 기본적으로 차단되어 있으며, 특정한 규칙에 따라 허용될 수 있다.
예를 들어, 외부에서의 VPN 접속 허용, 외부에서의 특정한 포트에 대한 접근 허용 등이 가능하다.
Inbound 정책
Inbound 정책은 외부에서 내부 네트워크로 들어오는 트래픽을 관리하는 정책입니다.
Inbound 정책에서는 외부에서 내부로의 접근을 허용할지, 차단할지를 결정합니다.
예를 들어, 웹 서버로의 접근을 허용하거나, SSH 접근을 차단하는 등의 규칙을 설정할 수 있습니다.
Outbound 정책
Outbound 정책은 내부에서 외부로 나가는 트래픽을 관리
```

```
vi /etc/sysconfig/network-scripts/ifcfg-ens33
vi /etc/sysconfig/selinux
SELINUX=enforcing => disabled 로바꿔야함.
reeboot
firewall-cmd --add-service=ftp --permanent
yum -y install vsftpd
systemctl enable --now vsftpd
vi /etc/vsftpd/vsftpd.conf
:set nu =>넘버 설정.
12번째 줄에 주석# 이없나 확인.
16번재 줄에 주석# 이없나 확인.
19번째 줄에 주석# 이없나 확인.
23 umask 022 맞나 확인
29 주석제거.
33 주석제거.
87 배너나오게 주석 제거.
:wq
systemctl restart vsftpd.service
ifconfig   =>ip다시 한번 확인.
cd /var/ftp/
ls -l   =>외부에서 접속하면 pub을 들여다보는데 소유권이 root.
chown ftp:ftp pub   =>ftp에게 소유권 이전.
chmod 777 pub   =>읽기쓰기권한을 다줬다 (실습이라 다준거지 현업에선 사실 다주면안됨.)
cd pub
cat > test_ftp
입력 후 저장
호스트 컴퓨터로 핑 날린 후
알드라이브 설치
192.168.1.8 (실제 컴퓨터 리눅스 ip를 입력)


실제 컴퓨터에서 .txt 파일을 넣으면, 리눅스에서 ls -l 명령어로 확인되는 것을 볼 수 있다.
```

```
rpm -qa | grep http
yum -y install httpd*
setenforce 0
 firewall-cmd --add-service=http --permanent
 firewall-cmd --add-service=https --permanent
cd /var/www
cd html
vi index.html    
systemctl enable --now httpd
systemctl status httpd
```


```
vi /etc/sysconfig/network-scripts/ifcfg-ens33
vi /etc/sysconfig/selinux
SELINUX=enforcing
reeboot
firewall-cmd --add-service=ftp --permanent
yum -y install vsftpd
systemctl enable --now vsftpd
vi /etc/vsftpd/vsftpd.conf
:set nu
:wq
systemctl restart vsftpd.service
chown ftp:ftp pub
chmod 777 pub
cd pub
cat > test_ftp
```

```
rpm -qa | grep http   => 확인시 설치된것이 없다.
yum -y install httpd* => http설치.
setenforce 0          => selinux 해제.
firewall-config       => 2차 방화벽 설정. 런타임/영구적 둘다 http, https를 체크.
cd /var/www
cd html
ls -l             => html 이 755 임을 확인.
ps -ef | grep yum => yum의 프로세스가 여러개가 뜨는것이 확인되면 kill 명령어로 죽여야함.
vi index.html     => 전에 만든 html 형식의 내용을 붙여넣었다.
systemctl restart vsftpd
cd /var/ftp/pub 
ls -l
chmod 755 파일명
chmod 755 파일명
cp boa.jpg boa_valenti.mp4 /var/www/html/ => ftp에 받아온 파일을 html 폴더로 복사.
cd /var/www/html
systemctl start httpd
systemctl status httpd => Active 임을 확인.

systemctl start / stop =>restart로 해결이 안될때 사용*
```

```
rpm -qa | grep http
yum -y install httpd*
setenforce 0
 firewall-cmd --add-service=http --permanent
 firewall-cmd --add-service=https --permanent
cd /var/www
cd html
vi index.html
cd /var/ftp/pub
chmod 755 boa1.jpg
chmod 755 boa2.mp4
cp boa1.jpg boa2.mp4 /var/www/html/
systemctl enable --now httpd
systemctl status httpd
```

chmod 755    
systemctl enable --now httpd
systemctl status httpd

```
CE]
ip domain-name kedu.edu
crypto key generate rsa
768
ip ssh version 2
username admin100 password admin100
username monitor password monitor
username user1 password user1
line vty 0 4
login local
exit
enable secret cisco
aaa new-mode
tacacs-server host 172.16.50.103 single-connection key cisco
aaa authentication login default group tacasc+ local
end
test aaa group tacacs+ admin100 admin100 legacy
conf t
no aaa authentication login default group tacasc+ local
aaa authentication login VTY_ACC group tacacs+ local
line vty 0 4
login authentication VTY_ACC
exit
username admin100 privilege 15 password admin100
aaa authorization exec VTY_PRI group tacacs+ local
aaa authorization commands 15 VTY_PRI group tacacs+ local
line vty 0 4
authorization exec VTY_PRI
authorization commands 15 VTY_PRI
exit
aaa accounting exec ACC start-stop group tacasc+
aaa accounting commands 15 ACC start-stop group tacacs+
line vty 0 4
accounting exec ACC
accounting commands 15 ACC
```
